function detect_old_ie(){if(!/MSIE (\d+\.\d+);/.test(navigator.userAgent))return!1;var t=new Number(RegExp.$1);return!(t>=9)&&(t>=8||(t>=7||(t>=6||(t>=5||void 0))))}/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var t,o=location.hash.substring(1);/^[A-z0-9_-]+$/.test(o)&&(t=document.getElementById(o))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())},!1),window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,20)},function(t){function o(o,e){this.xzoom=!0;var i,s,n,a,p,l,r,d,c,h,f,u,v,m,g,w,x,b,z,y,C,k,O,M,A,I,S,H,W,E,F,T,X,Y,R,L,q,D,_,Z,$,B,N,j,Q,G,J,K,P,U,V,tt=this,ot={},et=(new Array,new Array),it=0,st=0,nt=0,at=0,pt=0,lt=0,rt=0,dt=0,ct=0,ht=0,ft=0,ut=0,vt=0,mt=detect_old_ie(),gt=/MSIE (\d+\.\d+);/.test(navigator.userAgent),wt="";function xt(){var t=document.documentElement;return{left:(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0),top:(window.pageYOffset||t.scrollTop)-(t.clientTop||0)}}function bt(){if("circle"==tt.options.lensShape&&"lens"==tt.options.position){var t=((A=I=Math.max(A,I))+2*Math.max(E,W))/2;O.css({"-moz-border-radius":t,"-webkit-border-radius":t,"border-radius":t})}}function zt(t,o,e,i){"lens"==tt.options.position?(k.css({top:-(o-r)*T+I/2,left:-(t-d)*F+A/2}),tt.options.bg&&(O.css({"background-image":"url("+k.attr("src")+")","background-repeat":"no-repeat","background-position":-(t-d)*F+A/2+"px "+(-(o-r)*T+I/2)+"px"}),e&&i&&O.css({"background-size":e+"px "+i+"px"}))):k.css({top:-H*T,left:-S*F})}function yt(t,o){var e,i;nt<-1&&(nt=-1),nt>1&&(nt=1),X<Y?i=(e=a*(X-(X-1)*nt))/R:e=(i=p*(Y-(Y-1)*nt))*R,D?(at=t,pt=o,lt=e,rt=i):(D||(dt=lt=e,ct=rt=i),A=a/(F=e/s),I=p/(T=i/n),bt(),kt(t,o),k.width(e),k.height(i),O.width(A),O.height(I),O.css({top:H-E,left:S-W}),M.css({top:-H,left:-S}),zt(t,o,e,i))}function Ct(){var t=ht,o=ft,e=ut,i=vt,l=dt,r=ct;t+=(at-t)/tt.options.smoothLensMove,o+=(pt-o)/tt.options.smoothLensMove,e+=(at-e)/tt.options.smoothZoomMove,i+=(pt-i)/tt.options.smoothZoomMove,l+=(lt-l)/tt.options.smoothScale,r+=(rt-r)/tt.options.smoothScale,A=a/(F=l/s),I=p/(T=r/n),bt(),kt(t,o),k.width(l),k.height(r),O.width(A),O.height(I),O.css({top:H-E,left:S-W}),M.css({top:-H,left:-S}),kt(e,i),zt(t,o,l,r),ht=t,ft=o,ut=e,vt=i,dt=l,ct=r,D&&requestAnimFrame(Ct)}function kt(t,o){S=(t-=d)-A/2,H=(o-=r)-I/2,"lens"!=tt.options.position&&tt.options.lensCollision&&(S<0&&(S=0),s>=A&&S>s-A&&(S=s-A),s<A&&(S=s/2-A/2),H<0&&(H=0),n>=I&&H>n-I&&(H=n-I),n<I&&(H=n/2-I/2))}function Ot(){void 0!==g&&g.remove(),void 0!==x&&x.remove(),void 0!==N&&N.remove()}function Mt(t){var o=t.attr("title"),e=t.attr("xtitle");return e||(o||"")}this.adaptive=function(){0!=G&&0!=J||(o.css("width",""),o.css("height",""),G=o.width(),J=o.height()),Ot(),j=t(window).width(),Q=t(window).height(),K=o.width(),P=o.height();var e=!1;(G>j||J>Q)&&(e=!0),K>G&&(K=G),P>J&&(P=J),e?o.width("100%"):0!=G&&o.width(G),"fullscreen"!=U&&(!function(){var e=o.offset();a="auto"==tt.options.zoomWidth?K:tt.options.zoomWidth;p="auto"==tt.options.zoomHeight?P:tt.options.zoomHeight;"#"==tt.options.position.substr(0,1)?ot=t(tt.options.position):ot.length=0;if(0!=ot.length)return!0;switch(U){case"lens":case"inside":return!0;case"top":r=e.top,d=e.left,c=r-p,h=d;break;case"left":r=e.top,d=e.left,c=r,h=d-a;break;case"bottom":r=e.top,d=e.left,c=r+P,h=d;break;case"right":default:r=e.top,d=e.left,c=r,h=d+K}if(h+a>j||h<0)return!1;return!0}()?tt.options.position=tt.options.mposition:tt.options.position=U),tt.options.lensReverse||(V=tt.options.adaptiveReverse&&tt.options.position==tt.options.mposition)},this.xscroll=function(t){if(v=t.pageX||t.originalEvent.pageX,m=t.pageY||t.originalEvent.pageY,t.preventDefault(),t.xscale)nt=t.xscale,yt(v,m);else{var o=-t.originalEvent.detail||t.originalEvent.wheelDelta||t.xdelta,e=v,i=m;mt&&(e=_,i=Z),nt+=o=o>0?-.05:.05,yt(e,i)}},this.openzoom=function(e){switch(v=e.pageX,m=e.pageY,tt.options.adaptive&&tt.adaptive(),nt=tt.options.defaultScale,D=!1,g=t("<div></div>"),""!=tt.options.sourceClass&&g.addClass(tt.options.sourceClass),g.css("position","absolute"),b=t("<div></div>"),""!=tt.options.loadingClass&&b.addClass(tt.options.loadingClass),b.css("position","absolute"),w=t('<div style="position: absolute; top: 0; left: 0;"></div>'),g.append(b),x=t("<div></div>"),""!=tt.options.zoomClass&&"fullscreen"!=tt.options.position&&x.addClass(tt.options.zoomClass),x.css({position:"absolute",overflow:"hidden",opacity:1}),tt.options.title&&""!=wt&&(N=t("<div></div>"),B=t("<div></div>"),N.css({position:"absolute",opacity:1}),tt.options.titleClass&&B.addClass(tt.options.titleClass),B.html("<span>"+wt+"</span>"),N.append(B),tt.options.fadeIn&&N.css({opacity:0})),O=t("<div></div>"),""!=tt.options.lensClass&&O.addClass(tt.options.lensClass),O.css({position:"absolute",overflow:"hidden"}),tt.options.lens&&(lenstint=t("<div></div>"),lenstint.css({position:"absolute",background:tt.options.lens,opacity:tt.options.lensOpacity,width:"100%",height:"100%",top:0,left:0,"z-index":9999}),O.append(lenstint)),function(e,v){switch("fullscreen"==tt.options.position?(s=t(window).width(),n=t(window).height()):(s=o.width(),n=o.height()),b.css({top:n/2-b.height()/2,left:s/2-b.width()/2}),(l=tt.options.rootOutput||"fullscreen"==tt.options.position?o.offset():o.position()).top=Math.round(l.top),l.left=Math.round(l.left),tt.options.position){case"fullscreen":r=xt().top,d=xt().left,c=0,h=0;break;case"inside":r=l.top,d=l.left,c=0,h=0;break;case"top":r=l.top,d=l.left,c=r-p,h=d;break;case"left":r=l.top,d=l.left,c=r,h=d-a;break;case"bottom":r=l.top,d=l.left,c=r+n,h=d;break;case"right":default:r=l.top,d=l.left,c=r,h=d+s}r-=g.outerHeight()/2,d-=g.outerWidth()/2,"#"==tt.options.position.substr(0,1)?ot=t(tt.options.position):ot.length=0,0==ot.length&&"inside"!=tt.options.position&&"fullscreen"!=tt.options.position?(tt.options.adaptive&&G&&J||(G=s,J=n),a="auto"==tt.options.zoomWidth?s:tt.options.zoomWidth,p="auto"==tt.options.zoomHeight?n:tt.options.zoomHeight,c+=tt.options.Yoffset,h+=tt.options.Xoffset,x.css({width:a+"px",height:p+"px",top:c,left:h}),"lens"!=tt.options.position&&i.append(x)):"inside"==tt.options.position||"fullscreen"==tt.options.position?(a=s,p=n,x.css({width:a+"px",height:p+"px"}),g.append(x)):(a=ot.width(),p=ot.height(),tt.options.rootOutput?(c=ot.offset().top,h=ot.offset().left,i.append(x)):(c=ot.position().top,h=ot.position().left,ot.parent().append(x)),c+=(ot.outerHeight()-p-x.outerHeight())/2,h+=(ot.outerWidth()-a-x.outerWidth())/2,x.css({width:a+"px",height:p+"px",top:c,left:h})),tt.options.title&&""!=wt&&("inside"==tt.options.position||"lens"==tt.options.position||"fullscreen"==tt.options.position?(f=c,u=h,g.append(N)):(f=c+(x.outerHeight()-p)/2,u=h+(x.outerWidth()-a)/2,i.append(N)),N.css({width:a+"px",height:p+"px",top:f,left:u})),g.css({width:s+"px",height:n+"px",top:r,left:d}),w.css({width:s+"px",height:n+"px"}),tt.options.tint&&"inside"!=tt.options.position&&"fullscreen"!=tt.options.position?w.css("background-color",tt.options.tint):mt&&w.css({"background-image":"url("+o.attr("src")+")","background-color":"#fff"}),C=new Image;var m="";switch(gt&&(m="?r="+(new Date).getTime()),C.src=o.attr("xoriginal")+m,(k=t(C)).css("position","absolute"),(C=new Image).src=o.attr("src"),(M=t(C)).css("position","absolute"),M.width(s),tt.options.position){case"fullscreen":case"inside":x.append(k);break;case"lens":O.append(k),tt.options.bg&&k.css({display:"none"});break;default:x.append(k),O.append(M)}}(),"inside"!=tt.options.position&&"fullscreen"!=tt.options.position?((tt.options.tint||mt)&&g.append(w),tt.options.fadeIn&&(w.css({opacity:0}),O.css({opacity:0}),x.css({opacity:0})),i.append(g)):(tt.options.fadeIn&&x.css({opacity:0}),i.append(g)),tt.eventmove(g),tt.eventleave(g),tt.options.position){case"inside":c-=(x.outerHeight()-x.height())/2,h-=(x.outerWidth()-x.width())/2;break;case"top":c-=x.outerHeight()-x.height(),h-=(x.outerWidth()-x.width())/2;break;case"left":c-=(x.outerHeight()-x.height())/2,h-=x.outerWidth()-x.width();break;case"bottom":h-=(x.outerWidth()-x.width())/2;break;case"right":c-=(x.outerHeight()-x.height())/2}x.css({top:c,left:h}),k.xon("load",function(t){if(b.remove(),!tt.options.openOnSmall&&(k.width()<a||k.height()<p))return tt.closezoom(),t.preventDefault(),!1;tt.options.scroll&&tt.eventscroll(g),"inside"!=tt.options.position&&"fullscreen"!=tt.options.position?(g.append(O),tt.options.fadeIn?(w.fadeTo(300,tt.options.tintOpacity),O.fadeTo(300,1),x.fadeTo(300,1)):(w.css({opacity:tt.options.tintOpacity}),O.css({opacity:1}),x.css({opacity:1}))):tt.options.fadeIn?x.fadeTo(300,1):x.css({opacity:1}),tt.options.title&&""!=wt&&(tt.options.fadeIn?N.fadeTo(300,1):N.css({opacity:1})),L=k.width(),q=k.height(),tt.options.adaptive&&(s<G||n<J)&&(M.width(s),M.height(n),L*=s/G,q*=n/J,k.width(L),k.height(q)),dt=lt=L,ct=rt=q,R=L/q,X=L/a,Y=q/p;var o,e=["padding-","border-"];E=W=0;for(var i=0;i<e.length;i++)o=parseFloat(O.css(e[i]+"top-width")),E+=o!=o?0:o,o=parseFloat(O.css(e[i]+"bottom-width")),E+=o!=o?0:o,o=parseFloat(O.css(e[i]+"left-width")),W+=o!=o?0:o,o=parseFloat(O.css(e[i]+"right-width")),W+=o!=o?0:o;E/=2,W/=2,ut=ht=at=v,vt=ft=pt=m,yt(v,m),tt.options.smooth&&(D=!0,requestAnimFrame(Ct)),tt.eventclick(g)})},this.movezoom=function(t){v=t.pageX,m=t.pageY,mt&&(_=v,Z=m);var o=v-d,e=m-r;V&&(t.pageX-=2*(o-s/2),t.pageY-=2*(e-n/2)),(o<0||o>s||e<0||e>n)&&g.trigger("mouseleave"),tt.options.smooth?(at=t.pageX,pt=t.pageY):(bt(),kt(t.pageX,t.pageY),O.css({top:H-E,left:S-W}),M.css({top:-H,left:-S}),zt(t.pageX,t.pageY,0,0))},this.eventdefault=function(){tt.eventopen=function(t){t.xon("mouseenter",tt.openzoom)},tt.eventleave=function(t){t.xon("mouseleave",tt.closezoom)},tt.eventmove=function(t){t.xon("mousemove",tt.movezoom)},tt.eventscroll=function(t){t.xon("mousewheel DOMMouseScroll",tt.xscroll)},tt.eventclick=function(t){t.xon("click",function(t){o.trigger("click")})}},this.eventunbind=function(){o.xoff("mouseenter"),tt.eventopen=function(t){},tt.eventleave=function(t){},tt.eventmove=function(t){},tt.eventscroll=function(t){},tt.eventclick=function(t){}},this.init=function(e){tt.options=t.extend({},t.fn.xzoom.defaults,e),i=tt.options.rootOutput?t("body"):o.parent(),U=tt.options.position,V=tt.options.lensReverse&&"inside"==tt.options.position,tt.options.smoothZoomMove<1&&(tt.options.smoothZoomMove=1),tt.options.smoothLensMove<1&&(tt.options.smoothLensMove=1),tt.options.smoothScale<1&&(tt.options.smoothScale=1),tt.options.adaptive&&t(window).xon("load",function(){G=o.width(),J=o.height(),tt.adaptive(),t(window).resize(tt.adaptive)}),tt.eventdefault(),tt.eventopen(o)},this.destroy=function(){tt.eventunbind()},this.closezoom=function(){D=!1,tt.options.fadeOut?(tt.options.title&&""!=wt&&N.fadeOut(299),"inside"!=tt.options.position||"fullscreen"!=tt.options.position?(x.fadeOut(299),g.fadeOut(300,function(){Ot()})):g.fadeOut(300,function(){Ot()})):Ot()},this.gallery=function(){var t,o=new Array,e=0;for(t=st;t<et.length;t++)o[e]=et[t],e++;for(t=0;t<st;t++)o[e]=et[t],e++;return{index:st,ogallery:et,cgallery:o}},this.xappend=function(e){var i=e.parent();function s(s){Ot(),s.preventDefault(),tt.options.activeClass&&($.removeClass(tt.options.activeClass),($=e).addClass(tt.options.activeClass)),st=t(this).data("xindex"),tt.options.fadeTrans&&((y=new Image).src=o.attr("src"),(z=t(y)).css({position:"absolute",top:o.offset().top,left:o.offset().left,width:o.width(),height:o.height()}),t(document.body).append(z),z.fadeOut(200,function(){z.remove()}));var n=i.attr("href"),a=e.attr("xpreview")||e.attr("src");wt=Mt(e),e.attr("title")&&o.attr("title",e.attr("title")),o.attr("xoriginal",n),o.removeAttr("style"),o.attr("src",a),tt.options.adaptive&&(G=o.width(),J=o.height())}et[it]=i.attr("href"),i.data("xindex",it),0==it&&tt.options.activeClass&&($=e).addClass(tt.options.activeClass),0==it&&tt.options.title&&(wt=Mt(e)),it++,tt.options.hover&&i.xon("mouseenter",i,s),i.xon("click",i,s)},this.init(e)}t.fn.xon=t.fn.on||t.fn.bind,t.fn.xoff=t.fn.off||t.fn.bind,t.fn.xzoom=function(e){var i,s;if(this.selector){var n=this.selector.split(",");for(var a in n)n[a]=t.trim(n[a]);this.each(function(a){if(1==n.length)if(0==a){if(void 0!==(i=t(this)).data("xzoom"))return i.data("xzoom");i.x=new o(i,e)}else void 0!==i.x&&(s=t(this),i.x.xappend(s));else if(t(this).is(n[0])&&0==a){if(void 0!==(i=t(this)).data("xzoom"))return i.data("xzoom");i.x=new o(i,e)}else void 0===i.x||t(this).is(n[0])||(s=t(this),i.x.xappend(s))})}else this.each(function(n){if(0==n){if(void 0!==(i=t(this)).data("xzoom"))return i.data("xzoom");i.x=new o(i,e)}else void 0!==i.x&&(s=t(this),i.x.xappend(s))});return void 0!==i&&(i.data("xzoom",i.x),t(i).trigger("xzoom_ready"),i.x)},t.fn.xzoom.defaults={position:"right",mposition:"inside",rootOutput:!0,Xoffset:0,Yoffset:0,fadeIn:!0,fadeTrans:!0,fadeOut:!1,smooth:!0,smoothZoomMove:3,smoothLensMove:1,smoothScale:6,defaultScale:0,scroll:!0,tint:!1,tintOpacity:.5,lens:!1,lensOpacity:.5,lensShape:"box",lensCollision:!0,lensReverse:!1,openOnSmall:!0,zoomWidth:"auto",zoomHeight:"auto",sourceClass:"xzoom-source",loadingClass:"xzoom-loading",lensClass:"xzoom-lens",zoomClass:"xzoom-preview",activeClass:"xactive",hover:!1,adaptive:!0,adaptiveReverse:!1,title:!1,titleClass:"xzoom-caption",bg:!1}}(jQuery);